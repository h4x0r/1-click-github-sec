=== INSTALLATION SESSION START ===
Timestamp: 2025年 9月25日 星期四 07時38分25秒 HKT
Script: ./install-security-controls.sh 
PWD: /Users/4n6h4x0r/src/1-click-github-sec
User: 4n6h4x0r
========================================
[2025-09-25 07:38:25] [INFO] [print_status] ════════════════════════════════════════════════
[2025-09-25 07:38:25] [INFO] [print_status]   Security Controls Installer v0.3.1
[2025-09-25 07:38:25] [INFO] [print_status] ════════════════════════════════════════════════
[2025-09-25 07:38:25] [INFO] [start_transaction] Transaction started: security-controls-install
[2025-09-25 07:38:25] [INFO] [print_status] ══════════════════════════════════════════════════════════════
[2025-09-25 07:38:25] [INFO] [print_status]   🛡️  1-Click GitHub Security Controls v0.3.1
[2025-09-25 07:38:25] [INFO] [print_status]   👨‍💻  Created by Albert Hui <albert@securityronin.com>
[2025-09-25 07:38:25] [INFO] [print_status]      Security Ronin
[2025-09-25 07:38:25] [INFO] [print_status] ══════════════════════════════════════════════════════════════
[2025-09-25 07:38:25] [INFO] [main] === Security Controls Installation Started ===
[2025-09-25 07:38:25] [INFO] [main] Script version: 0.3.1
[2025-09-25 07:38:25] [INFO] [main] Arguments: --force --no-github-security --no-ci --no-docs
[2025-09-25 07:38:25] [INFO] [print_status] ✅ Git repository detected
[2025-09-25 07:38:25] [INFO] [print_status] 🔍 Auto-detecting project language(s)...
[2025-09-25 07:38:25] [INFO] [print_status]   ✅ Rust detected (Cargo.toml found)
[2025-09-25 07:38:25] [INFO] [print_status] 🎯 Single-language repository: rust
[2025-09-25 07:38:25] [INFO] [print_status] ▶ Checking Required Tools
[2025-09-25 07:38:25] [INFO] [print_status] ✅ git: /opt/homebrew/bin/git
[2025-09-25 07:38:25] [INFO] [print_status] ✅ curl: /opt/anaconda3/bin/curl
[2025-09-25 07:38:25] [INFO] [print_status] ✅ jq: /opt/anaconda3/bin/jq
[2025-09-25 07:38:25] [INFO] [print_status] ✅ cargo: /Users/4n6h4x0r/.cargo/bin/cargo
[2025-09-25 07:38:25] [INFO] [print_status] ✅ rustc: /Users/4n6h4x0r/.cargo/bin/rustc
[2025-09-25 07:38:25] [INFO] [print_status] ▶ Installing Security Tools
[2025-09-25 07:38:25] [INFO] [print_status] ⚠️ RUSTUP_TOOLCHAIN is set to '1.87.0' — this overrides the default toolchain.
[2025-09-25 07:38:25] [INFO] [print_status]    Optional cargo installs may fail or use a non-default toolchain. Using 'cargo +stable' for installs.
[2025-09-25 07:38:25] [INFO] [print_status]    To avoid this, unset RUSTUP_TOOLCHAIN before running the installer.
[2025-09-25 07:38:25] [INFO] [print_status] 🦀 Installing Rust security tools...
[2025-09-25 07:38:25] [INFO] [print_status] ✅ cargo-deny already installed
[2025-09-25 07:38:25] [INFO] [print_status] ✅ cargo-geiger already installed
[2025-09-25 07:38:25] [INFO] [print_status] ✅ cargo-cyclonedx already installed
[2025-09-25 07:38:25] [INFO] [print_status] ✅ cargo-machete already installed
[2025-09-25 07:38:25] [INFO] [print_status] 🔄 Ensuring fallback security tools...
[2025-09-25 07:38:25] [INFO] [print_status] ▶ Installing Gitsign for Sigstore Signing
[2025-09-25 07:38:25] [INFO] [print_status] ✅ gitsign already installed
[2025-09-25 07:38:25] [INFO] [print_status] 🔧 Configuring gitsign for manual authentication...
[2025-09-25 07:38:26] [INFO] [print_status] ✅ Gitsign configured with balanced security and usability
[2025-09-25 07:38:26] [INFO] [print_status]    • Browser auto-closes after 20 seconds (enough time for auth)
[2025-09-25 07:38:26] [INFO] [print_status]    • Uses GitHub OAuth for identity verification
[2025-09-25 07:38:26] [INFO] [print_status]    • Ephemeral certificates with transparency logging
[2025-09-25 07:38:26] [INFO] [print_status] 🧪 Testing gitsign configuration...
[2025-09-25 07:38:26] [INFO] [print_status] ✅ Gitsign ready for commit signing
[2025-09-25 07:38:26] [INFO] [print_status]    Next commit will be signed with Sigstore
[2025-09-25 07:38:26] [INFO] [print_status] 💡 Authentication Behavior:
[2025-09-25 07:38:26] [INFO] [print_status] 🔧 Troubleshooting Authentication Failures:
[2025-09-25 07:38:26] [INFO] [print_status] ▶ Configuring Cargo.toml Security Settings
[2025-09-25 07:38:26] [INFO] [print_status] ✅ overflow-checks already configured in Cargo.toml
[2025-09-25 07:38:26] [INFO] [print_status] ✅ deny.toml already exists
[2025-09-25 07:38:26] [INFO] [print_status] 📝 Configuring secure .cargo/config.toml...
[2025-09-25 07:38:26] [INFO] [print_status] ℹ️  .cargo/config.toml exists - adding security settings
[2025-09-25 07:38:26] [INFO] [print_status] ▶ Installing Default Security Configuration
[2025-09-25 07:38:26] [INFO] [print_status] ℹ️ Existing config preserved at .security-controls/config.env
[2025-09-25 07:38:26] [INFO] [print_status] ℹ️ Existing gitleaks config preserved at .security-controls/gitleaks.toml
[2025-09-25 07:38:26] [INFO] [print_status] ▶ Installing script-only pinactlite helper
[2025-09-25 07:38:26] [INFO] [print_status] ✅ Copied pinactlite from canonical source
[2025-09-25 07:38:26] [INFO] [print_status] ✅ Installed script-only pinactlite at .security-controls/bin/pinactlite
[2025-09-25 07:38:26] [INFO] [print_status] ▶ Installing script-only gitleakslite helper
[2025-09-25 07:38:26] [INFO] [print_status] ✅ Copied gitleakslite from canonical source
[2025-09-25 07:38:26] [INFO] [print_status] ✅ Installed script-only gitleakslite at .security-controls/bin/gitleakslite
[2025-09-25 07:38:26] [INFO] [print_status] ▶ Installing Pre-Push Hook
[2025-09-25 07:38:26] [INFO] [print_status] ✅ Pre-push hook installed: .git/hooks/pre-push
[2025-09-25 07:38:26] [INFO] [print_status] ════════════════════════════════════════════════
[2025-09-25 07:38:26] [INFO] [print_status]   Installation Complete
[2025-09-25 07:38:26] [INFO] [print_status] ════════════════════════════════════════════════
[2025-09-25 07:38:26] [INFO] [print_status] ✅ Security controls successfully installed!
[2025-09-25 07:38:26] [INFO] [print_status] 📋 Pre-Push Hook:
[2025-09-25 07:38:26] [INFO] [print_status]    ✅ Installed to .git/hooks/pre-push
[2025-09-25 07:38:26] [INFO] [print_status]    🔍 Validates: format, lint, security, tests, secrets, licenses, SHA pinning, size, tech debt, empty files
[2025-09-25 07:38:26] [INFO] [print_status]    ⚡ Pre-push aims to complete in ~55–75 seconds
[2025-09-25 07:38:26] [INFO] [print_status] 🎯 Next Steps:
[2025-09-25 07:38:26] [INFO] [print_status] 💡 Pro Tips:
[2025-09-25 07:38:26] [INFO] [print_status] 🛡️  Your repository is now secured with comprehensive controls!
[2025-09-25 07:38:26] [INFO] [print_status] 📝 Version information saved to .security-controls-version
[2025-09-25 07:38:26] [INFO] [commit_transaction] Transaction committed successfully
[2025-09-25 07:38:26] [INFO] [main] === Installation Completed Successfully ===
